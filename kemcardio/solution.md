# Метод решения

Как было сказано выше, в данной работе используется метод погруженной границы
[@peskin2002immersed]. В соответствии с этим методом, будем рассчитывать
течение жидкости в параллелепипеде $\tilde{\Omega}$, который включает в себя
$\Omega$. На границах $\tilde{\Omega}$ задано условие прилипания. Для расчета
течения жидкости будем использовать прямоугольную равномерную разнесенную сетку
$\tilde{\Omega_h}$ с шагами $h_{xi}, h_{yj}, h_{zk}$ и шахматным расположением
узлов, где давление, дивергенция скорости и концентрация определяются в центре
ячейки, а компоненты вектора скорости  и внешних сил – на границах. Для
определения деформации поверхности $\Gamma_1 \cup \Gamma_4$ введем
дополнительную область $\tilde{\Gamma}$ системой координат, соотнесенной со
стенками сосуда и створками клапана. В области $\tilde{\Gamma}$ точкам на
$\Gamma_1 \cup \Gamma_4$. Алгоритм решения состоит из нескольких шагов: на
сетке $\tilde{\Omega_h}$  решаем задачу
([@eq:navier_stokes:motion])-([@eq:navier_stokes:pressure_conditions]); затем
решаем уравнение конвекции ([@eq:convection]) т.е. определяем концентрацию
примеси в области решения и пересчитываем значение плотности и вязкости. После
этого используем формулы ([@eq:resulting_force])  и
([@eq:interaction:velocity]), ([@eq:interaction:force]) для определения
положения створок клапана и формы

![Расчетные области, используемые в методе погруженной
границы](aorta_valve_computation_scheme.png) {#fig:aorta_valve_computation_scheme}

Поставленная дифференциальная задача ([@eq:navier_stokes:motion]) –
([@eq:density]) решается методом конечных разностей. Для решения
([@eq:navier_stokes:motion]) – ([@eq:navier_stokes:pressure_conditions]) будем
использовать схемы расщепления по физическим факторам
[@белоцерковский1984численное]:

$$\frac{u^* - u^n}{\triangle t} = - (u^n \cdot \nabla) u^* - \frac{1}{\rho}
\nabla \sigma + f^n$$ {#eq:splitting:intermediate_velocity}

$$\rho \triangle p^{n+1} - \nabla \rho \cdot p^{n+1} = \frac{\rho^2 \nabla
u^*}{\triangle t} $$ {#eq:splitting:poisson}

$$\frac{u^{n+1} - u^*}{\triangle t} = - \frac{1}{\rho} \triangle p^{n+1} $$
{#eq:splitting:velocity}

Численная реализация схемы состоит из 3-х этапов. Сначала по известным
значениям скорости с предыдущего временного слоя находится промежуточное поле
$u^*$. Для этого уравнение ([@eq:splitting:intermediate_velocity]) решается
методом стабилизирующей поправки [@яненко1967метод]. Затем, путем численного
решения ([@eq:splitting:poisson]) с использованием метода бисопряженных
градиентов, определяется новое поле давления. И на последнем этапе
восстанавливается окончательное поле вектора скорости по явным формулам
([@eq:splitting:velocity]).

После нахождения параметров течения жидкости необходимо вычислить новые
значения плотности и вязкости. Для этого, используя полученные значения
компонент скорости, делается шаг  по времени для уравнения конвекции
([@eq:convection]), и производится пересчет значений плотности и вязкости по
формулам ([@eq:viscosity]), ([@eq:density]).

Далее нам необходимо определять деформацию стенок сосуда и створок клапана под
воздействием жидкости, а также распределение массовых сил fв уравнении движения
жидкости исходя из возникшей деформации. Используя уравнения
([@eq:interaction:velocity]) – ([@eq:interaction:force]), которые численно
интегрируются с помощью какой-либо квадратурной формулы, и уравнение
([@eq:resulting_force]), мы можем рассчитать деформацию, которой подвергаются
стенки сосуда и клапан при данном давлении жидкости и возникающую силу
сопротивления $F$. После этого пересчитываем массовые силы $f$ и переходим на
следующий шаг по времени.
