# Метод решения

Как было сказано выше, в данной работе используется метод погруженной границы
[@peskin2002immersed]. В соответствии с этим методом, будем рассчитывать
течение жидкости в параллелепипеде $\tilde{\Omega}$, который включает в себя
$\Omega$. На границах $\tilde{\Omega}$ задано условие прилипания. Для расчета
течения жидкости будем использовать прямоугольную равномерную разнесенную сетку
$\tilde{\Omega_h}$ с шагами $h_{xi}, h_{yj}, h_{zk}$ и шахматным расположением
узлов, где давление, дивергенция скорости и концентрация определяются в центре
ячейки, а компоненты вектора скорости  и внешних сил – на границах. Для
определения деформации поверхности $\Gamma_1 \cup \Gamma_4$ введем
дополнительную область $\tilde{\Gamma}$ системой координат, соотнесенной со
стенками сосуда и створками клапана. В области $\tilde{\Gamma}$ точкам на
$\Gamma_1 \cup \Gamma_4$. Алгоритм решения состоит из нескольких шагов: на
сетке $\tilde{\Omega_h}$  решаем задачу
([@w:navier_stokes:motion])-([@eq:navier_stokes:pressure_conditions]); затем
решаем уравнение конвекции ([@w:convection]) т.е. определяем концентрацию
примеси в области решения и пересчитываем значение плотности и вязкости. После
этого используем формулы ([@w:resulting_force])  и
([@w:interaction:velocity]), ([@eq:interaction:force]) для определения
положения створок клапана и формы

Поставленная дифференциальная задача ([@w:navier_stokes:motion]) –
([@w:density]) решается методом конечных разностей. Для решения
([@w:navier_stokes:motion]) – ([@eq:navier_stokes:pressure_conditions]) будем
использовать схемы расщепления по физическим факторам
[@белоцерковский1984численное]:

$$\frac{u^* - u^n}{\triangle t} = - (u^n \cdot \nabla) u^* - \frac{1}{\rho} \nabla \sigma + f^n$$ {#w:splitting:intermediate_velocity}

$$\rho \triangle p^{n+1} - \nabla \rho \cdot p^{n+1} = \frac{\rho^2 \nabla u^*}{\triangle t} $$ {#w:splitting:poisson}

$$\frac{u^{n+1} - u^*}{\triangle t} = - \frac{1}{\rho} \triangle p^{n+1} $$ {#w:splitting:velocity}

Численная реализация схемы состоит из 3-х этапов. Сначала по известным
значениям скорости с предыдущего временного слоя находится промежуточное поле
$u^*$. Для этого уравнение ([@w:splitting:intermediate_velocity]) решается
методом стабилизирующей поправки [@яненко1967метод]. Затем, путем численного
решения ([@w:splitting:poisson]) с использованием метода бисопряженных
градиентов, определяется новое поле давления. И на последнем этапе
восстанавливается окончательное поле вектора скорости по явным формулам
([@w:splitting:velocity]).
